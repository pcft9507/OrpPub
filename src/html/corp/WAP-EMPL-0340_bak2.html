@@include('./head.html', {title: ""})
<body>
  <div class="wrap">

    @@include('./header.html')
    
    <!-- container -->
    <div class="container">
      @@include('./snb.html', {type: "기업담당자", dep1: "3"})

      <div class="contents-header">
        <div class="contents-header__title-cell">
          <h2 class="contents-header--title">[ORP연구소] 2021년 하반기 인턴 채용</h2>
          <div class="cell">
            <div class="dropdown" style="width: 128px;">
              <button type="button" class="dropdown-btn type3"
                data-dropdown='{
                  "name": "headerDropdown",
                  "type" : "single",
                  "option": [
                    {
                      "name": "사무",
                      "value": "사무",
                      "disabled": false,
                      "checked": true
                    },
                    {
                      "name": "옵션2",
                      "value": "옵션2",
                      "disabled": false,
                      "checked": false
                    }
                  ]
                }'
              >선택하세요</button>
              <script>
                dropdown.init('dropdown', {
                  name: 'headerDropdown',
                  onChange: _this=>{
                    console.log(_this.value);
                  }
                });
              </script>
            </div>
          </div>
          <div class="cell">
            <div class="dropdown" style="width: 128px;">
              <button type="button" class="dropdown-btn type3"
                data-dropdown='{
                  "name": "headerDropdown2",
                  "type" : "single",
                  "option": [
                    {
                      "name": "서류전형",
                      "value": "서류전형",
                      "disabled": false,
                      "checked": true
                    },
                    {
                      "name": "옵션2",
                      "value": "옵션2",
                      "disabled": false,
                      "checked": false
                    }
                  ]
                }'
              >선택하세요</button>
              <script>
                dropdown.init('dropdown', {
                  name: 'headerDropdown2',
                  onChange: _this=>{
                    console.log(_this.value);
                  }
                });
              </script>
            </div>
          </div>
        </div>
        <div class="contents-header__btns">
          <a href="#" class="btn">
            <span class="base-icon icon-folder__size-m__color5">전형관리</span>
          </a>
          <a href="#" class="btn">
            <span class="base-icon icon-trophy__size-m__color5">합격자 발표</span>
          </a>
          <a href="#" class="btn">
            <span class="base-icon icon-graph__size-m__color5">통계</span>
          </a>
        </div>
      </div>

      <!-- contents navigation -->
      <div class="contents-nav type2">
        <div class="contents-nav__inner">
          <div class="contents-nav__btn-box"></div>
          <div class="contents-nav__btn-box">
            <button type="button" class="base-btn type2__size-m">취소</button>
            <button type="button" class="base-btn type1__size-m">저장</button>
          </div>
        </div>
      </div>
      <!-- //contents navigation -->

      <!-- contents -->
      <div class="contents">
        <div class="base-tab tab-type1" data-ref="tabContents1">
          <ul class="tab__list" role="tablist">
            <li class="tab__item">
              <button role="tab" aria-selected="true">면접도구</button>
            </li>
            <li class="tab__item">
              <button role="tab" aria-selected="false">평가자</button>
            </li>
            <li class="tab__item">
              <button role="tab" aria-selected="false">집계기준</button>
            </li>
            <li class="tab__item">
              <button role="tab" aria-selected="false">등급</button>
            </li>
            <li class="tab__item">
              <button role="tab" aria-selected="false">평가시스템 설정</button>
            </li>
          </ul>
        </div>
        <script>
          const tabContents1 = new TabContents({target: 'tabContents1'});
        </script>

        <div class="wrap-box">
          <section class="form-set__box content-mt4" data-ref="controlWrap-main">
            <div class="form-set__header">
              <div class="form-set__cell">
                <h4 class="title-sub">면접도구(<span>1</span>)</h4>
              </div>
              <div class="form-set__btn type-gap2">
                <button type="button" class="base-btn type2__size-s">
                  <span class="base-icon icon-down__size-s__color1">불러오기</span>
                </button>
                <button type="button" class="base-btn type2__size-s" onclick="">추가하기</button>
              </div>
            </div>
            <div class="box-type1 content-mt3">
              <div class="table table-type1 overflow-initial" data-ref="add-interview">
                <table class="type-input type-line">
                  <colgroup>
                    <col>
                    <col>
                    <col>
                  </colgroup>
                  <thead>
                  <tr>
                    <th>면접명</th>
                    <th>시작날짜</th>
                    <th>종료날짜</th>
                  </tr>
                  </thead>
                  <tbody class="first-td-bdt0" data-ref="controlTable">
                  <tr>
                    <td colspan="3">
                      <div class="form-inner type-gap2">
                        <div class="d-flex w-full type-gap">
                          <button type="button" class="btn-item--del" onclick="">
                            <span>삭제</span>
                          </button>

                          <div class="input-box h-full">
                            <input type="text" class="input-txt" placeholder="입력하세요" oninput="inputValueChk()">
                            <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                          </div>
                        </div>

                        <div class="d-flex w-full type-gap">
                          <div class="input-box type-calendar" style="flex: 1;">
                            <input type="text" class="input-txt" id="calendar2_1" placeholder="시작 일자 선택" oninput="inputValueChk()">
                            <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                          </div>

                          <div class="input-box" style="width: 69px;">
                            <input class="input-txt ph-0 tac timepicker" type='text' name='timepicker' placeholder="시간 선택">
                          </div>
                        </div>

                        <div class="d-flex w-full type-gap">
                          <div class="input-box type-calendar" style="flex: 1;">
                            <input type="text" class="input-txt" id="calendar2_2" placeholder="일자 선택" oninput="inputValueChk()">
                            <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                          </div>

                          <div class="input-box" style="width: 69px;">
                            <input class="input-txt ph-0 tac timepicker" type='text'name='timepicker' placeholder="시간 선택">
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                  </tbody>
                </table>
                <div class="d-flex content-mt2 type-pd2">
                  <button type="button" class="btn-item--add" onclick="extendRowItemAdd(18, event.target.querySelector('[data-ref=add-interview]'))">
                    <span>추가하기</span>
                  </button>
                </div>
              </div>

              <!-- 평가요소 -->
              <div class="board-head flex-end content-mt5">
                <div class="board-head__cell">
                  <button type="button" class="base-btn type2__size-s" onclick="controlWrap.add();">
                    <span class="base-icon icon-down__size-s__color1">불러오기</span>
                  </button>
                </div>
              </div>
              <div class="content-mt2" data-ref="controlWrap">
                <section class="form-set__box">
                  <div class="box-type5">
                    <div class="form-set__header">
                      <div class="form-set__cell">
                        <h4 class="title-sub1">평가요소 1</h4>
                      </div>
                      <div class="form-set__btn type-gap2">
                        <button type="button" onclick="controlWrap.itemDown('.form-set__box');">
                          <span class="base-icon icon-down2__size-m__color3">
                            <span class="isHidden">아래로</span>
                          </span>
                        </button>
                        <button type="button" onclick="controlWrap.itemUp('.form-set__box');">
                          <span class="base-icon icon-up__size-m__color3">
                            <span class="isHidden">위로</span>
                          </span>
                        </button>
                        <button type="button" class="base-btn type-icon__color1" onclick="controlWrap.del('.form-set__box');">
                          <span class="base-icon icon-del__size-s__color3">
                            <strong class="font-size-l">삭제</strong>
                          </span>
                        </button>
                      </div>
                    </div>
                    <div class="box-type1">
                      <div class="form-row__flex">
                        <div class="form-th" style="width: 240px;">평가요소명</div>
                        <div class="form-td" style="flex: 1;">
                          <div class="input-box" style="width: 100%;">
                            <input type="text" class="input-txt" oninput="inputValueChk()" placeholder="입력해주세요." value="지원동기">
                            <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                          </div>
                        </div>
                      </div>
                      <div class="form-row__flex">
                        <div class="form-th" style="width: 240px;">정의</div>
                        <div class="form-td" style="flex: 1;">
                          <div class="input-box" style="width: 100%;">
                            <input type="text" class="input-txt" oninput="inputValueChk()" placeholder="입력하세요.">
                            <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                          </div>
                        </div>
                      </div>
                      <div class="form-row__flex">
                        <div class="form-th" style="width: 240px;">하위요소</div>
                        <div class="form-td" style="flex: 1;">
                          <div class="form-inner type-gap2">
                            <button type="button" class="btn-item--del" onclick="rowItemDel();">
                              <span>삭제</span>
                            </button>
                            <div class="input-box" style="width: 100%;">
                              <input type="text" class="input-txt" oninput="inputValueChk()" placeholder="하위요소명 입력">
                              <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                            </div>
                            <div class="input-box" style="width: 100%;">
                              <input type="text" class="input-txt" oninput="inputValueChk()" placeholder="하위요소명 입력" value="ORP 연구소와 지원분야에 지원한 동기가 분명하게 작성되어 있다">
                              <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                            </div>
                          </div>
                          <div class="form-inner type-gap2">
                            <button type="button" class="btn-item--del" onclick="rowItemDel();">
                              <span>삭제</span>
                            </button>
                            <div class="input-box" style="width: 100%;">
                              <input type="text" class="input-txt" oninput="inputValueChk()" placeholder="하위요소명 입력">
                              <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                            </div>
                            <div class="input-box" style="width: 100%;">
                              <input type="text" class="input-txt" oninput="inputValueChk()" placeholder="하위요소명 입력" value="성의있게 지원서를 작성했다">
                              <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                            </div>
                          </div>
                          <div class="form-inner">
                            <button type="button" class="btn-item--add" onclick="rowItemAdd(4);">
                              <span>하위요소 추가</span>
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </section>
              </div>
              <div class="form-set__add">
                <button type="button" class="btn-item--add" onclick="">
                  <span>평가요소 추가</span>
                </button>
              </div>
            </div>
          </section>
        </div>
      </div>
      <!-- //contents -->
    </div>
    <!-- //container -->
  </div>
<script src="../../assets/js/timepicki.js"></script>
<script>
  const controlTable = new ControlAddItem({
    target: 'controlTable',
    wrapTag: 'tr',
    template: `
                    <td colspan="3">
                      <div class="form-inner type-gap2">
                        <div class="d-flex w-full type-gap">
                          <button type="button" class="btn-item--del" onclick="controlTable.del('tr');">
                            <span>삭제</span>
                          </button>

                          <div class="input-box h-full">
                            <input type="text" class="input-txt" placeholder="입력하세요" oninput="inputValueChk()">
                            <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                          </div>
                        </div>

                        <div class="d-flex w-full type-gap">
                          <div class="input-box type-calendar" style="flex: 1;">
                            <input type="text" class="input-txt" id="calendar2_1" placeholder="시작 일자 선택" oninput="inputValueChk()">
                            <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                          </div>

                          <div class="input-box" style="width: 69px;">
                            <input class="input-txt ph-0 tac timepicker" type='text'name='timepicker' placeholder="시간 선택">
                          </div>
                        </div>

                        <div class="d-flex w-full type-gap">
                          <div class="input-box type-calendar" style="flex: 1;">
                            <input type="text" class="input-txt" id="calendar2_2" placeholder="일자 선택" oninput="inputValueChk()">
                            <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                          </div>

                          <div class="input-box" style="width: 69px;">
                            <input class="input-txt ph-0 tac timepicker" type='text'name='timepicker' placeholder="시간 선택">
                          </div>
                        </div>
                      </div>
                    </td>

                  `
  });

  // 새로운 행이 추가될 때마다 호출되는 함수
  function initializeTimePicker() {
    $('.timepicker').timepicki({
      show_meridian: false,
      min_hour_value: 0,
      max_hour_value: 23
    });
  }

  // 초기화할 때 호출
  initializeTimePicker();

  // 새로운 행이 추가될 때마다 시간 선택기를 초기화하기 위해 이벤트 위임 사용
  $(document).on('DOMNodeInserted', function (e) {
    if ($(e.target).find('.timepicker').length > 0) {
      initializeTimePicker();
    }
  })

  // 템플릿 추가
  const extendRowItemAdd = (num, targetEl) => {
    const _this = event.currentTarget;
    let target = _this.closest('.form-inner');
    let template;

    // 기존 case들은 그대로 유지됩니다.

    // 새로운 case 추가
    switch (num) {
      case 18: {
        template = `
                  <tr>
                    <td colspan="3">
                      <div class="form-inner type-gap2">
                        <div class="d-flex w-full type-gap">
                          <button type="button" class="btn-item--del" onclick="">
                            <span>삭제</span>
                          </button>

                          <div class="input-box h-full">
                            <input type="text" class="input-txt" placeholder="입력하세요" oninput="inputValueChk()">
                            <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                          </div>
                        </div>

                        <div class="d-flex w-full type-gap">
                          <div class="input-box type-calendar" style="flex: 1;">
                            <input type="text" class="input-txt" id="calendar2_1" placeholder="시작 일자 선택" oninput="inputValueChk()">
                            <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                          </div>

                          <div class="input-box" style="width: 69px;">
                            <input class="input-txt ph-0 tac timepicker" type='text' name='timepicker' placeholder="시간 선택">
                          </div>
                        </div>

                        <div class="d-flex w-full type-gap">
                          <div class="input-box type-calendar" style="flex: 1;">
                            <input type="text" class="input-txt" id="calendar2_2" placeholder="일자 선택" oninput="inputValueChk()">
                            <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                          </div>

                          <div class="input-box" style="width: 69px;">
                            <input class="input-txt ph-0 tac timepicker" type='text'name='timepicker' placeholder="시간 선택">
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
            `;
        break;
      }
      case 19: {
        template = `
        <div class="box-type5">
          <div class="form-set__header">
            <div class="form-set__cell">
              <h4 class="title-sub1">평가요소 1</h4>
            </div>
            <div class="form-set__btn type-gap2">
              <button type="button" onclick="controlWrap.itemDown('.form-set__box');">
                <span class="base-icon icon-down2__size-m__color3">
                  <span class="isHidden">아래로</span>
                </span>
              </button>
              <button type="button" onclick="controlWrap.itemUp('.form-set__box');">
                <span class="base-icon icon-up__size-m__color3">
                  <span class="isHidden">위로</span>
                </span>
              </button>
              <button type="button" class="base-btn type-icon__color1" onclick="controlWrap.del('.form-set__box');">
                <span class="base-icon icon-del__size-s__color3">
                  <strong class="font-size-l">삭제</strong>
                </span>
              </button>
            </div>
          </div>
          <div class="box-type1">
            <div class="form-row__flex">
              <div class="form-th" style="width: 240px;">평가요소명</div>
              <div class="form-td" style="flex: 1;">
                <div class="input-box" style="width: 100%;">
                  <input type="text" class="input-txt" oninput="inputValueChk()" placeholder="입력해주세요." value="지원동기">
                  <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                </div>
              </div>
            </div>
            <div class="form-row__flex">
              <div class="form-th" style="width: 240px;">정의</div>
              <div class="form-td" style="flex: 1;">
                <div class="input-box" style="width: 100%;">
                  <input type="text" class="input-txt" oninput="inputValueChk()" placeholder="입력하세요.">
                  <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                </div>
              </div>
            </div>
            <div class="form-row__flex">
              <div class="form-th" style="width: 240px;">하위요소</div>
              <div class="form-td" style="flex: 1;">
                <div class="form-inner type-gap2">
                  <button type="button" class="btn-item--del" onclick="rowItemDel();">
                    <span>삭제</span>
                  </button>
                  <div class="input-box" style="width: 100%;">
                    <input type="text" class="input-txt" oninput="inputValueChk()" placeholder="하위요소명 입력">
                    <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                  </div>
                  <div class="input-box" style="width: 100%;">
                    <input type="text" class="input-txt" oninput="inputValueChk()" placeholder="하위요소명 입력" value="ORP 연구소와 지원분야에 지원한 동기가 분명하게 작성되어 있다">
                    <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                  </div>
                </div>
                <div class="form-inner type-gap2">
                  <button type="button" class="btn-item--del" onclick="rowItemDel();">
                    <span>삭제</span>
                  </button>
                  <div class="input-box" style="width: 100%;">
                    <input type="text" class="input-txt" oninput="inputValueChk()" placeholder="하위요소명 입력">
                    <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                  </div>
                  <div class="input-box" style="width: 100%;">
                    <input type="text" class="input-txt" oninput="inputValueChk()" placeholder="하위요소명 입력" value="성의있게 지원서를 작성했다">
                    <button type="button" class="btn-del" onclick="inputValueDel()">입력 삭제</button>
                  </div>
                </div>
                <div class="form-inner">
                  <button type="button" class="btn-item--add" onclick="rowItemAdd(4);">
                    <span>하위요소 추가</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
            `;
        break;
      }

        if (targetEl) {
          targetEl.insertAdjacentHTML('beforeend', template)
        } else {
          target.insertAdjacentHTML('beforebegin', template);
        }
    }
  }

  // 기존 rowItemAdd 함수를 호출하면서 확장 함수를 실행하도록 수정
  const originalRowItemAdd = rowItemAdd; // 기존 함수를 originalRowItemAdd에 저장
  rowItemAdd = (num, targetEl) => {
    // 기존 함수 호출
    originalRowItemAdd(num, targetEl);
    // 확장 함수 실행
    extendRowItemAdd(num, targetEl);
  }


</script>
</body>
</html>