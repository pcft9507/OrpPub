<div class="layer-popup type-modal upload-excel" data-ref="WAP-CONT-0100">
  <section class="popup__container popup__size-m">
    <div class="popup__header">
      <h3 class="popup__title">엑셀 등록</h3>
    </div>
    <div class="popup__contents popup__scroll-view">
      
      <input id="excelUpload" type="file" name="files" title="파일 업로드" multiple>

      <div class="upload-area">
        <p class="ua-txt">파일을 끌어서 첨부할 수 있습니다.</p>
        <button class="btn-upload base-btn type2__size-s">파일 직접 선택</button>
      </div>

      <div class="file-list"></div>

      <p class="guide-download">엑셀 등록을 위해서는 샘플 양식에 맞춰 엑셀을 등록해야합니다. <a href="#">샘플양식 다운로드</a></p>
    </div>
    
    <div class="popup__btn-wrap">
      <button class="base-btn type1__size-m">저장</button>
    </div>
    <button class="btn-close" onclick="WAP_CONT_0100.hide()">닫기</button>
  </section>
</div>

<script>
  // 드래그앤 드롭
  var uploadExcel = document.querySelector('.upload-excel');
  var btnUpload = uploadExcel.querySelector('.btn-upload');
  var inputFile = uploadExcel.querySelector('#excelUpload');
  var uploadBox = uploadExcel.querySelector('.upload-area');
  var fileList = uploadExcel.querySelector('.file-list'); // 파일 목록을 표시할 ul 요소

  console.log(btnUpload)

  /* 박스 안에 Drag를 하고 있을 때 */
  uploadBox.addEventListener('dragover', function(e) {
    e.preventDefault();
    console.log('dragover');
    var vaild = e.dataTransfer.types.indexOf('Files') >= 0;
  });
  
  /* 박스 밖으로 Drag가 나갈 때 */
  uploadBox.addEventListener('dragleave', function(e) {});
  
  /* 박스 안에서 Drag를 Drop했을 때 */
  uploadBox.addEventListener('drop', function(e) {
    e.preventDefault(); // 기본 이벤트 방지

    var files = e.dataTransfer.files; // 드롭한 파일들

    // 파일 리스트 초기화
    fileList.innerHTML = '';

    // 드롭한 파일 각각에 대해 처리
    Array.from(files).forEach(function(file) {
      var createdEl = document.createElement('div'); // 요소 생성
      createdEl.textContent = file.name; // 파일 이름으로 요소의 텍스트 설정
      fileList.appendChild(createdEl); // 생성된 요소를 fileList에 추가
    });
  });
  
  btnUpload.addEventListener('click', function () {
    excelUpload.click();
  });

  // inputFile에도 동일하게 적용하여 파일 선택 시 목록을 업데이트하도록 합니다.
  inputFile.addEventListener('change', function(e) {
    var files = e.target.files; // 선택한 파일들

    // 파일 리스트 초기화
    fileList.innerHTML = '';

    // 선택한 파일 각각에 대해 처리
    Array.from(files).forEach(function(file) {
      var createdEl = document.createElement('div'); // 요소 생성
      createdEl.textContent = file.name; // 파일 이름으로 요소의 텍스트 설정
      fileList.appendChild(createdEl); // 생성된 요소를 fileList에 추가
    });
  });

  // 파일 유효성 검사 함수
  function isValid(data){
		
		//파일인지 유효성 검사
		if(data.types.indexOf('Files') < 0)
			return false;
		
		//이미지인지 유효성 검사
		if(data.files[0].type.indexOf('image') < 0){
			alert('이미지 파일만 업로드 가능합니다.');
			return false;
		}
		
		//파일의 개수는 1개씩만 가능하도록 유효성 검사
		if(data.files.length > 1){
			alert('파일은 하나씩 전송이 가능합니다.');
			return false;
		}
		
		//파일의 사이즈는 50MB 미만
		if(data.files[0].size >= 1024 * 1024 * 50){
			alert('50MB 이상인 파일은 업로드할 수 없습니다.');
			return false;
		}
		
		return true;
	}

  const WAP_CONT_0100 = new LayerPopup({target: "WAP-CONT-0100"});
</script>